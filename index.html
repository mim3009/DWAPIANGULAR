<!DOCTYPE html>
<html ng-app="sitegenesisStore">
<head>
	<title>Main Page</title>
	<link rel="stylesheet" type="text/css" href="stylesheets/style.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.1/angular.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.2.0.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script>
		angular.module('sitegenesisStore', ['cart'])
			.controller('mainCtrl', function ($scope, $http) {
				$scope.storeName = "STOREFRONT SHOP";

				$scope.data = {};

				$scope.getProducts = function (productsQuery) {
					$http({
						method : "GET",
						url : "/getProduct",
						params : {"query" : productsQuery}
					}).then(function (response) {
						$scope.data.products = response.data;
					}, function (error) {
						//$scope.data.error = error;
						console.log(error);
					});
				};

				var login = function () {
					$http({
						method : "GET",
						url : "/login",
					}).then(function (response) {
						$scope.token = response.data;
					}, function (error) {
						//$scope.data.error = error;
						console.log(error);
					});
				}

				login();
			})
			.directive("productGrid", function () {
				return {
					restrict : "E",
					templateUrl : "./views/productGridTemplate.html",
					scope : {
						products : "=products"
					},
					controller : function ($scope, cart) {
						$scope.addProductToCart = function (product) {
							cart.addProduct(product);
						}
					}
				}
			});
	</script>
	<script src="components/cart/cart.js"></script>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
</head>
<body ng-controller="mainCtrl">
	<nav class="navbar navbar-inverse" role="navigation">
		<div class="navbar-header">
		    <a class="navbar-brand" href="#">{{storeName}}</a>
		</div>

		<div class="col-sm-3 col-md-3">
	        <form class="navbar-form" role="search" ng-submit="getProducts(productsQuery)">
		        <div class="input-group">
		            <input type="text" class="form-control" ng-model="productsQuery" placeholder="Search for products">
		            <div class="input-group-btn">
		                <button class="btn btn-primary" type="submit"><i class="glyphicon glyphicon-search"></i></button>
		            </div>
		        </div>
	        </form>
	    </div>
	    <cart-summary/>
	</nav>
	
	<product-grid products="data.products"/>

	<script src="javascripts/functions.js"></script>
	<script src="https://www.paypalobjects.com/api/checkout.js"></script>
</body>
</html>